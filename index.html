<!doctypehtml>
<html lang=en>
  <head>
    <script defer src="./bingogoals.js"></script>
    <script defer>
        const el = e => document.getElementById(e);
        var req_pushed = new Set();
        var time_total = 0;
        window.addEventListener("load", () => {
             el("B").addEventListener("click", async function () {
                  var stream = await fetch("https://api.hypixel.net/resources/skyblock/bingo");
                  var object = await stream.json();
                  var array = object.goals;
                  while(array.length > 0){
                      var goal = array[0];
                      var filteredLore = goal.lore.replaceAll(/\xA7./g, "");
                      var TableObject = TABLE[filteredLore];
                      var string = `<div>${!!goal.tiers ? "[COMMUNITY] " : ""}<span>${filteredLore}</span><br><span>Data Time Estimate: `;
                      if(TableObject) {
                          string += `${TableObject.time}`;
                          if(!req_pushed.has(TableObject.need)) {
                              req_pushed.add(TableObject.need);
                              array.push({lore: TableObject.need});
                          }
                          time_total += isNaN(parseInt(TableObject.time)) ? 0 : parseInt(TableObject.time) ==2147483647 ? 60 : parseInt(TableObject.time); 
                      }
                      el("root").innerHTML += string + "</span></div><br>";
                      
                      array.shift();
                  }
                  el("C").textContent = time_total;
                  el("B").style = "display: none;";
             });
        });
    </script>
  </head>
  <body>
    <h2>Bingo Card Difficulty Viewer</h2>
    <p id="A"></p>
    <button id="B">Click to load current Hypixel API data</button>
    <p>Total Time Estimate (WIP): <span id="C"></span></p>
    <h2>All Goals And Requirements</h2>
    <div id="root"></div>
  </body>
</html>
